import     
    sets,
    sequtils,
    strformat

# Removing duplicate elemnts from a sequence 
proc removeDuplicates[T](s: seq[T]): seq[T] =
    let uniqueSet = toHashSet(s) 
    result = toSeq(uniqueSet) 

proc suspiciousCommandsDroperTrojan * () : seq[string] = 
    @[
        "sh bins.sh",
        "&& chmod 777",
        "rm -rf bins.sh",
        "reeee/setup.sh;",
        "-c get tftp1.sh;",
        "chmod +x bins.sh",
        "rm -rf /tmp/*.history -c",
        "BootzIV.sh && ./BootzIV.sh",
        "ftpget -v -u anonymous -p anonymous -P",
        "rm -rf /var/log/wtmp.history -c;history -w",
        "rm -rf /tmp/* /var/* /var/run/* /var/tmp/*",
        "cd /tmp || cd /var/run || cd /mnt || cd /root || cd /;"
    ]

proc suspiciousStringsDroperTrojan * () : seq[string] = 
    @[
        "TERRARIA",
        "MINECRAFT",
        "FuckVulcan",
        "SCANNER ON | OFF.OFF.ON",
        "DDOS Attacks & Functions",
        "Fucking NeTiS and Thisity",
        "Successfully Bruteforced IP",
        "FAIL: bad source IPv4 address",
        "Ur FuCkInG FoReHeAd We BiG L33T HaxErS",
        "then you tcp dumped it because it hit you and you need to patch it lololololol",
        "I'm having a problem resolving my host, someone will have to SPOOFS me manually"
    ]

proc suspiciousIPCombinationDroperTrojan * (ip : string) : seq[string] =
    @[
        ip,
        ip & ".telnet",
        ip & "/bins.sh",
        "wget+" & ip,
        "wget " & ip,
        "HOST: " & ip,
        "wget -g" & ip,
        "curl -O " & ip,
        "wget -g " & ip & "-l /tmp/kh -r /mips",
    ]

proc virusRaportTrojan * (
        filename : string, 
        virus_type : string, 
        filesize : int,
        suspicious_ips : seq[string], 
        suspicious_commands : seq[string],
        suspicious_strings : seq[string]
    ) : string = 

    var comment : string = fmt"[WARNING!] File {filename} may be {virus_type} :" & '\n' & fmt"In the file were found the following : " & '\n' & fmt"File size : {filesize / 1000}KB" & '\n'
    if len(suspicious_ips) > 0 : comment = comment & fmt"SUSPICIOUS IPs : {removeDuplicates(suspicious_ips)}" & '\n'
    if len(suspicious_commands) > 0 : comment = comment & fmt"SUSPICIOUS COMMANDS : {removeDuplicates(suspicious_commands)}" & '\n'
    if len(suspicious_strings) > 0 : comment = comment & fmt"SUSPICIOUS STRINGS : {removeDuplicates(suspicious_strings)}" & '\n'

    comment & '\n'