rule pythonCryptography{
	meta : 
		author = "Z4que - All rights reverved"
		date = "22/01/2024"

	strings:
		$header = {7F 45 4C 46}
		$pyFile = "import" ascii wide
		$c1 = "xcryptography" ascii wide
		$c2 = "cryptography.hazmat.primitives" ascii wide
		$c3 = "cryptography.fernet" ascii wide

	condition : ($header at 0 or $pyFile at 0) and any of ($c*)
}
rule wannaCry{
	meta : 
		author = "Z4que - All rights reverved"
		date = "22/01/2024"

	strings:
		$header = {4D 5A}

		$c1 = "cmd.exe" ascii wide
		$c2 = "che.exe" ascii wide
		$c3 = "kdl.exe" ascii wide
		$c4 = "taskdl.exe" ascii wide
		$c5 = "taskse.exe" ascii wide

		#$t1 = "WNcry" ascii wide

	condition : $header at 0 and any of ($c*)
}
