rule pythonCryptography{
	meta : 
		author = "Z4que - All rights reverved"
		date = "22/01/2024"

	strings:
		$header = {7F 45 4C 46}
		$pyFile = "import" ascii wide
		$c1 = "xcryptography" ascii wide
		$c2 = "cryptography.hazmat.primitives" ascii wide
		$c3 = "cryptography.fernet" ascii wide

	condition : ($header at 0 or $pyFile at 0) and any of ($c*)
}
rule wannaCry{
	meta : 
		author = "Z4que - All rights reverved"
		date = "22/01/2024"

	strings:
		$header = {4D 5A}

		$c1 = "cmd.exe" ascii wide
		$c2 = "che.exe" ascii wide
		$c3 = "kdl.exe" ascii wide
		$c4 = "taskdl.exe" ascii wide
		$c5 = "taskse.exe" ascii wide

	condition : $header at 0 and any of ($c*)
}
rule lokiLocker{
	meta : 
		author = "Z4que - All rights reverved"
		date = "27/01/2024"

	strings:
		$header = { 4D 5A }
		$c1 = "This program cannot be run in DOS mode" ascii wide
		$c2 = "bytesToBeEncrypted" ascii wide

        //"your files have been encrypted"
		$c3 = { 59 00 6F 00 75 00 72 00 20 00 66 00 69 00 6C 00 65
        00 73 00 20 00 68 00 61 00 76 00 65 00 20 00 62 00 65 00 65
        00 6E 00 20 00 65 00 6E 00 63 00 72 00 79 00 70 00 74 00 65
        00 64}

        //"Your compuer is locked. Please do not close this window"
        $c4 = { 59 00 6F 00 75 00 72 00 20 00 63 00 6F 00 6D 00 70
        00 75 00 74 00 65 00 72 00 20 00 69 00 73 00 20 00 6C 00 6F
        00 63 00 6B 00 65 00 64 00 2E 00 20 00 50 00 6C 00 65 00 61
        00 73 00 65 00 20 00 64 00 6F 00 20 00 6E 00 6F 00 74 00 20
        00 63 00 6C 00 6F 00 73 00 65 00 20 00 74 00 68 00 69 00 73
        00 20 00 77 00 69 00 6E 00 64 00 6F 00 77 00 20 00 61 00 73
        00 20 00 74 00 68 00 61 00 74 00 20 00 77 00 69 00 6C 00 6C
        00 20 00 72 00 65 00 73 00 75 00 6C 00 74 00 20 00 69 00 6E
        00 20 00 73 00 65 00 72 00 69 00 6F 00 75 00 73 00 20 00 63
        00 6F 00 6D 00 70 00 75 00 74 00 65 00 72 00 20 00 64 00 61
        00 6D 00 61 00 67 00 65 }

        //"locked"
        $c5 = { 6C 00 6F 00 63 00 6B 00 65 00 64 }

        $c6 = "C:\\Users\\Tyler\\Desktop\\hidden-tear-master\\hidden-tear\\hidden-tear\\obj\\Debug\\VapeHacksLoader.pdb" ascii wide

	condition : ($header at 0) and any of ($c*)
}
rule grandCab{
	meta : 
		author = "Z4que - All rights reverved"
		date = "27/01/2024"

	strings:
		$header = { 4D 5A }

        $c1 = { 4A 61 6E 75 61 72 79 00 44 65 63 00 4E 6F 76 00 4F
        63 74 00 53 65 70 00 41 75 67 00 4A 75 6C 00 4A 75 6E 00 4D
        61 79 00 41 70 72 00 4D 61 72 00 46 65 62 00 4A 61 6E 00 }

        //installation program operation not complete
        $c2 = { 4F 00 70 00 65 00 72 00 61 00 7A 00 69 00 6F 00 6E
        00 65 00 20 00 64 00 65 00 6C 00 20 00 70 00 72 00 6F 00 67
        00 72 00 61 00 6D 00 6D 00 61 00 20 00 64 00 69 00 20 00 69
        00 6E 00 73 00 74 00 61 00 6C 00 6C 00 61 00 7A 00 69 00 6F
        00 6E 00 65 00 20 00 6E 00 6F 00 6E 00 20 00 63 00 6F 00 6D
        00 70 00 6C 00 65 00 74 00 61 00 74 00 61 }

	condition : ($header at 0) and any of ($c*)
}
