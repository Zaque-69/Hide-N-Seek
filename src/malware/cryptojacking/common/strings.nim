import 
    strformat,
    sequtils,
    sets

# Removing duplicate elemnts from a sequence 
proc removeDuplicates[T](s: seq[T]): seq[T] =
    let uniqueSet = toHashSet(s) 
    result = toSeq(uniqueSet) 

proc suspiciousMoneroComments * () : seq[string] = 
    @[
        "monero",
        "randomx",
        "wownero",
        "xmr-stak",
        "cryptonight",
        "cryptonight_v7",
        "Stak Monero Miner",
        "cryptonight-monerov7",
        "cryptonight-monerov8",
        "monero.xmr.arqma.ravencoin.raven",
        "failed to allocate RandomX datasets, switching to slow mode"
        ]

proc suspiciousMinerComments * () : seq[string] = 
    @[
        "https://ryo-currency.com",
        "Doing only a benchmark and exiting.",
        "To mine, remove the '--benchmark' option",
        "Your miner was unable to find a share in time",
        "You can use following keys to display reports",
        "Based on CPU mining code by tevador and SChernykh",
        "https://github.com/fireice-uk/cryptonote-speedup-demo",
        "The miner evaluates your system and prints a suggestion for the section",
        "The values are not optimal, please try to tweak the values based on notes in config.txt"
    ]

proc suspiciousCryptoComments * () : seq[string] = 
    @[
        "crypto/evp",
        "crypto/engine",
        "crypto/ec/ec_key",
        "crypto/ec/ec_mult",
        "crypto/ec/ec_kmeth",
        "crypto/modes/gcm128",
        "crypto/modes/ocb128",
        "crypto/ec/ecdsa_ossl",
        "crypto/asn1/a_strnid"
    ]

proc virusRaportMiner * (
        filename : string, 
        virus_type : string, 
        filesize : int, 
        suspicious_monero_comments : seq[string], 
        suspicious_miner_comments : seq[string], 
        suspicious_crypto_comments : seq[string]
    ) : string = 

    var comment : string = fmt"[WARNING!] File {filename} may be {virus_type} :" & '\n' & fmt"In the file were found the following : " & '\n' & fmt"File size : {filesize / 1000000}MB" & '\n' 
    if len(suspicious_monero_comments) > 0 : comment = comment & fmt"SUSPICIOUS MONERO : {removeDuplicates(suspicious_monero_comments)}" & '\n'
    if len(suspicious_miner_comments) > 0 : comment = comment & fmt"SUSPICIOUS MINER COMMANDS : {removeDuplicates(suspicious_miner_comments)}" & '\n'
    if len(suspicious_crypto_comments) > 0 : comment = comment & fmt"SUSPICIOUS CRYPRO COMMENTS : {removeDuplicates(suspicious_crypto_comments)}" & '\n'

    comment & '\n'