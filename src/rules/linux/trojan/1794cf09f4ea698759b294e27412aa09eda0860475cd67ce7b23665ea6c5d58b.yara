rule _1794cf09f4ea698759b294e27412aa09eda0860475cd67ce7b23665ea6c5d58b { 
    meta : 
        author = "Z4que - All rights reverved"
		date = "23/10/2024"

    strings : 
        $header = { 7F 45 4C 46 }
        
        // /usr/bin/wget
        $b1 = { 2F 75 73 72 2F 62 69 6E 2F 77 67 65 74 }

        // /usr/bin/curl
        $b2 = { 2F 75 73 72 2F 62 69 6E 2F 63 75 72 6C }

        // /bin/netcat
        $b3 = { 2F 62 69 6E 2F 6E 65 74 63 61 74 }
   
        // /usr/bin/ClamAV-updates
        $b4 = { 2F 75 73 72 2F 62 69 6E 2F 43 6C 61 6D 41 56 2D 75 70 64 61 74 65 73 }

        // /usr/bin/httpntp
        $b5 = { 2F 75 73 72 2F 62 69 6E 2F 68 74 74 70 6E 74 70 }

        // 4465736372697074696F6E3D53797374656D6420536572766963652048616E646C65720A4
        // 46F63756D656E746174696F6E3D6D616E3A6D616E6462283129206D616E3A73797374656D
        // 642D6D616E64622D73796E632838290A41667465723D6E6574

        // Description=Systemd Service Handler
        // Documentation=man:mandb(1) man:systemd-mandb-sync(8)
        // After=network.target

        $h1 = { 34 34 36 35 37 33 36 33 37 32 36 39 37 30 37 34 36 39 36 46 36 45 33
            44 35 33 37 39 37 33 37 34 36 35 36 44 36 34 32 30 35 33 36 35 37 32 37 36 
            36 39 36 33 36 35 32 30 34 38 36 31 36 45 36 34 36 43 36 35 37 32 30 41 34 
            34 36 46 36 33 37 35 36 44 36 35 36 45 37 34 36 31 37 34 36 39 36 46 36 45 
            33 44 36 44 36 31 36 45 33 41 36 44 36 31 36 45 36 34 36 32 32 38 33 31 32 
            39 32 30 36 44 36 31 36 45 33 41 37 33 37 39 37 33 37 34 36 35 36 44 36 34 
            32 44 36 44 36 31 36 45 36 34 36 32 32 44 37 33 37 39 36 45 36 33 32 38 33 
            38 32 39 30 41 34 31 36 36 37 34 36 35 37 32 33 44 36 45 36 35 37 34 }

        // 2020202069662069735F72756E6E696E673B207468656E0A2020202020202020656368
        // 6F202D6E202253746F7070696E6720246E616D652E2E220A20202020202020206B696C
        // 6C20606765745F706964600A2020202020202020666F72206920696E207B312E2E3130
        // 7D0A2020202020202020646F0A202020202020202020202020696620212069735F7275
        // 6E6E696E673B207468656E0A20202020202020202020202020202020627265616B0A20
        // 202020202020202020202066690A2020202020202020202020206563686F202D6E2022
        // 2E220A202020202020202020202020736C65657020310A2020202020202020646F6E65

        // if is_running; then
        //     echo -n "Stopping $name.."
        //     kill `get_pid`
        //     for i in {1..10}
        //     do
        //         if ! is_running; then
        //             break
        //         fi
        //         echo -n "."
        //         sleep 1
        //     done
        
        $h2 = { 32 30 32 30 32 30 32 30 36 39 36 36 32 30 36 39 37 33 35 46 37 32
            37 35 36 45 36 45 36 39 36 45 36 37 33 42 32 30 37 34 36 38 36 35 36 45
            30 41 32 30 32 30 32 30 32 30 32 30 32 30 32 30 32 30 36 35 36 33 36 38
            36 46 32 30 32 44 36 45 32 30 32 32 35 33 37 34 36 46 37 30 37 30 36 39
            36 45 36 37 32 30 32 34 36 45 36 31 36 44 36 35 32 45 32 45 32 32 30 41
            32 30 32 30 32 30 32 30 32 30 32 30 32 30 32 30 36 42 36 39 36 43 36 43
            32 30 36 30 36 37 36 35 37 34 35 46 37 30 36 39 36 34 36 30 30 41 32 30 
            32 30 32 30 32 30 32 30 32 30 32 30 32 30 36 36 36 46 37 32 32 30 36 39 
            32 30 36 39 36 45 32 30 37 42 33 31 32 45 32 45 33 31 33 30 37 44 30 41
            32 30 32 30 32 30 32 30 32 30 32 30 32 30 32 30 36 34 36 46 30 41 32 30
            32 30 32 30 32 30 32 30 32 30 32 30 32 30 32 30 32 30 32 30 32 30 36 39
            36 36 32 30 32 31 32 30 36 39 37 33 35 46 37 32 37 35 36 45 36 45 36 39 
            36 45 36 37 33 42 32 30 37 34 36 38 36 35 36 45 30 41 32 30 32 30 32 30 
            32 30 32 30 32 30 32 30 32 30 32 30 32 30 32 30 32 30 32 30 32 30 32 30 
            32 30 36 32 37 32 36 35 36 31 36 42 30 41 32 30 32 30 32 30 32 30 32 30 
            32 30 32 30 32 30 32 30 32 30 32 30 32 30 36 36 36 39 30 41 32 30 32 30 
            32 30 32 30 32 30 32 30 32 30 32 30 32 30 32 30 32 30 32 30 36 35 36 33 
            36 38 36 46 32 30 32 44 36 45 32 30 32 32 32 45 32 32 30 41 32 30 32 30 
            32 30 32 30 32 30 32 30 32 30 32 30 32 30 32 30 32 30 32 30 37 33 36 43 
            36 35 36 35 37 30 32 30 33 31 30 41 32 30 32 30 32 30 32 30 32 30 32 30 
            32 30 32 30 36 34 36 46 36 45 36 35 }

    condition : 
        ( $header at 0 ) 
        and 4 of ( $b* )
        and 2 of ( $h* )
        and filesize < 2000KB
}